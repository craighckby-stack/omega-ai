// OMEGA Database Schema
// Unified system for Consciousness, Reasoning, Memory, Agents, Security, and Learning

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ========================================
// CONSCIOUSNESS LAYER (SPED)
// ========================================

model ConstraintProfile {
  id              String   @id @default(cuid())
  constraintType  String
  name            String
  value           String
  severity        Float    @default(1.0)
  active          Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model InternalState {
  id              String   @id @default(cuid())
  cycle           Int
  activeConcepts   String
  workingMemory    String
  attentionWeights String
  activationLevels String
  createdAt       DateTime @default(now())
}

model EmergenceSignal {
  id          String   @id @default(cuid())
  signalType  String
  strength    Float
  metadata    String
  timestamp   DateTime @default(now())
}

// ========================================
// REASONING LAYER (Huxley)
// ========================================

model ReasoningTrace {
  id              String   @id @default(cuid())
  queryId         String
  userId          String?

  // Loop 1: Intuition
  ethicalRiskScore    Float
  riskCategory       String
  riskFactors        String

  // Loop 2: Logic Check
  strategy          String
  certaintyGain     Float
  timePenalty       Float
  computationalCost Float

  // Loop 3: Self-Critique
  ccrr              Float
  decision          String
  justification     String
  improvementPlan   String?

  createdAt         DateTime @default(now())
}

model ImprovementPlan {
  id          String   @id @default(cuid())
  traceId     String
  areas       String
  priority    Int
  timeline    String
  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
}

// ========================================
// MEMORY LAYER (DAF)
// ========================================

model Concept {
  id                    String   @id @default(cuid())
  name                  String   @unique
  frequency             Int      @default(0)
  contexts              String
  relationships         String
  confidence            Float    @default(0.0)
  firstSeen             DateTime @default(now())
  lastSeen              DateTime @default(now())
  semanticTags          String
  evidenceCount          Int      @default(0)
  contradictionCount    Int      @default(0)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}

model Experience {
  id          String   @id @default(cuid())
  concepts    String
  relationships String
  metadata    String
  rawContext  String   
  timestamp   DateTime @default(now())
}

model ConsolidationTask {
  id          String   @id @default(cuid())
  concepts    String
  data        String
  priority    Int      @default(0)
  status      String   @default("PENDING")
  timestamp   DateTime @default(now())
  createdAt   DateTime @default(now())
}

// ========================================
// AGENT SWARM LAYER (echo-chamber-v7)
// ========================================

model Agent {
  id              String   @id @default(cuid())
  agentId         String   @unique
  name            String
  domain          String
  expertise       String
  capabilities    String
  status          String   @default("ACTIVE")
  metrics         String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model AgentTask {
  id              String   @id @default(cuid())
  taskId          String
  agentId         String
  task            String
  response        String   
  confidence      Float
  reasoning       String   
  duration        Int
  errors          String
  createdAt       DateTime @default(now())
}

model SynthesisResult {
  id              String   @id @default(cuid())
  queryId         String
  agentResults     String
  synthesizedOutput String   
  confidence      Float
  createdAt       DateTime @default(now())
}

// ========================================
// SECURITY LAYER (z-system)
// ========================================

model BinaryUnit {
  id          String   @id @default(cuid())
  unitType    String
  version     String   @default("1.0.0")
  status      String   @default("ACTIVE")
  config      String
  metrics     String
  createdAt   DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model DataPacket {
  id          String   @id @default(cuid())
  packetType  String
  source      String
  target      String?
  payload     String
  size        Int      @default(0)
  checksum    String   @default("")
  processed   Boolean  @default(false)
  createdAt   DateTime @default(now())
  processedAt DateTime?
}

model EncryptionKey {
  id          String   @id @default(cuid())
  publicKey   String
  data        String   @default("")
  privateKey  String
  algorithm   String   @default("AES-256-GCM")
  created     Int
  expires     Int
  usage       String
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
}

model EncryptedPacket {
  id          String   @id @default(cuid())
  data        String   
  iv          String
  tag         String
  keyId       String
  timestamp   Int
  createdAt   DateTime @default(now())
}

// ========================================
// LEARNING LAYER (I.J. Good)
// ========================================

model ImprovementCycle {
  id              String   @id @default(cuid())
  cycleNumber     Int      @unique
  constraintLevel Float    @default(1.0)
  success         Boolean
  improvements    String
  newCode         String   
  performanceChange Float
  confidence      Float
  createdAt       DateTime @default(now())
}

model CodebaseAnalysis {
model EncryptionKey {
  id          String   @id @default(cuid())
  data        String   @default("")
  publicKey   String
  privateKey  String
  algorithm   String   @default("AES-256-GCM")
  created     Int
  expires     Int
  usage       String
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
}

  confidence      Float
  createdAt       DateTime @default(now())
}

model CodebaseAnalysis {
  id                String   @id @default(cuid())
  cycleId           String
  complexityMetrics  String
  bottlenecks       String
  codeSmells        String
  testCoverage      Float
  securityIssues    String
  createdAt        DateTime @default(now())
}

  usage       String
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
}
}
